{{ 
  config(
    schema='br_ms_sinan',
    materialized='table',
     partition_by={
      "field": "ano",
      "data_type": "int64",
      "range": {
        "start": 2008,
        "end": 2025,
        "interval": 1}
    },
    labels =  {'tema': 'saude'}
    )
 }}

SELECT 
SAFE_CAST(ano AS INT64) ano,
SAFE_CAST(sigla_uf AS STRING) sigla_uf,
SAFE_CAST(data_notificacao AS DATE) data_notificacao,
SAFE_CAST(id_municipio_notificacao AS STRING) id_municipio_notificacao,
SAFE_CAST(id_municipio_6_notificacao AS STRING) id_municipio_6_notificacao,
SAFE_CAST(sistema AS STRING) sistema,
SAFE_CAST(id_estabelecimento_cnes AS STRING) id_estabelecimento_cnes,
SAFE_CAST(semana_notificacao AS INT64) semana_notificacao,
SAFE_CAST(data_primeiros_sintomas AS DATE) data_primeiros_sintomas,
SAFE_CAST(semana_sintomas AS DATE) semana_sintomas,
SAFE_CAST(paciente_estrangeiro AS STRING) paciente_estrangeiro,
SAFE_CAST(pais_residencia AS STRING) pais_residencia,
SAFE_CAST(sigla_uf_residencia AS STRING) sigla_uf_residencia,
SAFE_CAST(id_municipio_residencia AS STRING) id_municipio_residencia,
SAFE_CAST(id_municipio_6_residencia AS STRING) id_municipio_6_residencia,
SAFE_CAST(zona_residencia AS STRING) zona_residencia,
SAFE_CAST(caso_natural_residencia AS STRING) caso_natural_residencia,
SAFE_CAST(data_nascimento AS STRING) data_nascimento,
SAFE_CAST(sexo AS STRING) sexo,
SAFE_CAST(raca_cor AS STRING) raca_cor,
SAFE_CAST(etnia AS STRING) etnia,
SAFE_CAST(gestante AS STRING) gestante,
SAFE_CAST(puerpera AS STRING) puerpera,
SAFE_CAST(escolaridade AS STRING) escolaridade,
SAFE_CAST(ocupacao AS STRING) ocupacao,
SAFE_CAST(doenca_relacionada_trabalho AS STRING) doenca_relacionada_trabalho,
SAFE_CAST(tabagista AS STRING) tabagista,
SAFE_CAST(sindrome_gripal AS STRING) sindrome_gripal,
SAFE_CAST(infeccao_hospitalar AS STRING) infeccao_hospitalar,
SAFE_CAST(contato_aves_suinos AS STRING) contato_aves_suinos,
SAFE_CAST(contato_outro_animal AS STRING) contato_outro_animal,
SAFE_CAST(apresenta_febre AS STRING) apresenta_febre,
SAFE_CAST(apresenta_tosse AS STRING) apresenta_tosse,
SAFE_CAST(apresenta_calafrio AS STRING) apresenta_calafrio,
SAFE_CAST(apresenta_dor_garganta AS STRING) apresenta_dor_garganta,
SAFE_CAST(apresenta_dispneia AS STRING) apresenta_dispneia,
SAFE_CAST(apresenta_artralgia AS STRING) apresenta_artralgia,
SAFE_CAST(apresenta_mialgia AS STRING) apresenta_mialgia,
SAFE_CAST(apresenta_conjuntivite AS STRING) apresenta_conjuntivite,
SAFE_CAST(apresenta_coriza AS STRING) apresenta_coriza,
SAFE_CAST(apresenta_desconforto_respiratorio AS STRING) apresenta_desconforto_respiratorio,
SAFE_CAST(apresenta_saturacao_anormal AS STRING) apresenta_saturacao_anormal,
SAFE_CAST(apresenta_diarreia AS STRING) apresenta_diarreia,
SAFE_CAST(apresenta_vomito AS STRING) apresenta_vomito,
SAFE_CAST(apresenta_dor_abdominal AS STRING) apresenta_dor_abdominal,
SAFE_CAST(apresenta_fadiga AS STRING) apresenta_fadiga,
SAFE_CAST(apresenta_perda_olfato AS STRING) apresenta_perda_olfato,
SAFE_CAST(apresenta_perda_paladar AS STRING) apresenta_perda_paladar,
SAFE_CAST(apresenta_outros_sintomas AS STRING) apresenta_outros_sintomas,
SAFE_CAST(qual_outro_sintoma AS STRING) qual_outro_sintoma,
SAFE_CAST(apresenta_fator_risco AS STRING) apresenta_fator_risco,
SAFE_CAST(possui_cardiopatia AS STRING) possui_cardiopatia,
SAFE_CAST(possui_pneumopatia AS STRING) possui_pneumopatia,
SAFE_CAST(possui_hemoglobinopatia AS STRING) possui_hemoglobinopatia,
SAFE_CAST(possui_doenca_metabolica AS STRING) possui_doenca_metabolica,
SAFE_CAST(possui_sindrome_down AS STRING) possui_sindrome_down,
SAFE_CAST(possui_hepatite AS STRING) possui_hepatite,
SAFE_CAST(possui_doenca_neurologica AS STRING) possui_doenca_neurologica,
SAFE_CAST(possui_imunodeficiencia AS STRING) possui_imunodeficiencia,
SAFE_CAST(possui_doenca_renal AS STRING) possui_doenca_renal,
SAFE_CAST(possui_obesidade AS STRING) possui_obesidade,
SAFE_CAST(imc_obeso AS STRING) imc_obeso,
SAFE_CAST(possui_hematologia AS STRING) possui_hematologia,
SAFE_CAST(possui_asma AS STRING) possui_asma,
SAFE_CAST(possui_diabetes AS STRING) possui_diabetes,
SAFE_CAST(possui_outra_morbidade AS STRING) possui_outra_morbidade,
SAFE_CAST(qual_outra_morbidade AS STRING) qual_outra_morbidade,
SAFE_CAST(vacina_gripe AS STRING) vacina_gripe,
SAFE_CAST(data_ultima_dose AS DATE) data_ultima_dose,
SAFE_CAST(vacina_gripe_mae AS STRING) vacina_gripe_mae,
SAFE_CAST(data_vacina_mae AS DATE) data_vacina_mae,
SAFE_CAST(mae_amamenta AS STRING) mae_amamenta,
SAFE_CAST(data_vacina_crianca_dose_unica AS DATE) data_vacina_crianca_dose_unica,
SAFE_CAST(data_vacina_crianca_1dose AS DATE) data_vacina_crianca_1dose,
SAFE_CAST(data_vacina_crianca_2dose AS DATE) data_vacina_crianca_2dose,
SAFE_CAST(vacina_covid AS STRING) vacina_covid,
SAFE_CAST(data_vacina_covid_dose_1 AS STRING) data_vacina_covid_dose_1,
SAFE_CAST(data_vacina_covid_dose_2 AS STRING) data_vacina_covid_dose_2,
SAFE_CAST(laboratorio_vacina_covid AS STRING) laboratorio_vacina_covid,
SAFE_CAST(lote_dose1_vacina_covid AS STRING) lote_dose1_vacina_covid,
SAFE_CAST(lote_dose2_vacina_covid AS STRING) lote_dose2_vacina_covid,
SAFE_CAST(fonte_dados_vacina_covid AS STRING) fonte_dados_vacina_covid,
SAFE_CAST(antiviral_gripe AS STRING) antiviral_gripe,
SAFE_CAST(tipo_antiviral AS STRING) tipo_antiviral,
SAFE_CAST(outro_tipo_antiviral AS STRING) outro_tipo_antiviral,
SAFE_CAST(data_tratamento_antiviral AS DATE) data_tratamento_antiviral,
SAFE_CAST(internacao AS STRING) internacao,
SAFE_CAST(data_internacao AS DATE) data_internacao,
SAFE_CAST(sigla_uf_internacao AS STRING) sigla_uf_internacao,
SAFE_CAST(id_regional_saude_internacao AS STRING) id_regional_saude_internacao,
SAFE_CAST(id_municipio_internacao AS STRING) id_municipio_internacao,
SAFE_CAST(id_municipio_6_internacao AS STRING) id_municipio_6_internacao,
SAFE_CAST(internacao_uti AS STRING) internacao_uti,
SAFE_CAST(data_entrada_uti AS DATE) data_entrada_uti,
SAFE_CAST(data_saida_uti AS DATE) data_saida_uti,
SAFE_CAST(suporte_ventilatorio AS STRING) suporte_ventilatorio,
SAFE_CAST(resultado_raiox_torax AS STRING) resultado_raiox_torax,
SAFE_CAST(outro_resultado_raiox AS STRING) outro_resultado_raiox,
SAFE_CAST(data_raiox AS DATE) data_raiox,
SAFE_CAST(resultado_tomografia AS STRING) resultado_tomografia,
SAFE_CAST(outro_resultado_tomografia AS STRING) outro_resultado_tomografia,
SAFE_CAST(data_tomografia AS DATE) data_tomografia,
SAFE_CAST(coleta_amostra AS STRING) coleta_amostra,
SAFE_CAST(data_coleta AS DATE) data_coleta,
SAFE_CAST(tipo_amostra AS STRING) tipo_amostra,
SAFE_CAST(outro_tipo_amostra AS STRING) outro_tipo_amostra,
SAFE_CAST(resultado_amostra AS STRING) resultado_amostra,
SAFE_CAST(data_coleta_hemaglutinacao AS DATE) data_coleta_hemaglutinacao,
SAFE_CAST(resultado_hemaglutinacao AS STRING) resultado_hemaglutinacao,
SAFE_CAST(tipo_resultado_hemaglutinacao AS STRING) tipo_resultado_hemaglutinacao,
SAFE_CAST(hemaglutinacao_tipo_hemaglutinina AS STRING) hemaglutinacao_tipo_hemaglutinina,
SAFE_CAST(hemaglutinacao_tipo_neuraminidase AS STRING) hemaglutinacao_tipo_neuraminidase,
SAFE_CAST(tipo_pcr AS STRING) tipo_pcr,
SAFE_CAST(data_coleta_pcr AS DATE) data_coleta_pcr,
SAFE_CAST(tipo_amostra_pcr AS STRING) tipo_amostra_pcr,
SAFE_CAST(qual_outro_tipo_amostra_pcr AS STRING) qual_outro_tipo_amostra_pcr,
SAFE_CAST(data_resultado_pcr AS STRING) data_resultado_pcr,
SAFE_CAST(resultado_pcr AS STRING) resultado_pcr,
SAFE_CAST(diagnostico_pcr AS STRING) diagnostico_pcr,
SAFE_CAST(id_laboratorio_pcr AS STRING) id_laboratorio_pcr,
SAFE_CAST(tipo_resultado_pcr AS STRING) tipo_resultado_pcr,
SAFE_CAST(pcr_tipo_hemaglutinina AS STRING) pcr_tipo_hemaglutinina,
SAFE_CAST(pcr_tipo_neuraminidase AS STRING) pcr_tipo_neuraminidase,
SAFE_CAST(pcr_positivo_influenza AS STRING) pcr_positivo_influenza,
SAFE_CAST(tipo_influenza_pcr AS STRING) tipo_influenza_pcr,
SAFE_CAST(subtipo_influenza_a AS STRING) subtipo_influenza_a,
SAFE_CAST(outro_subtitpo_influenza AS STRING) outro_subtitpo_influenza,
SAFE_CAST(linhagem_influeza_b AS STRING) linhagem_influeza_b,
SAFE_CAST(outra_linhagem_influenza_b AS STRING) outra_linhagem_influenza_b,
SAFE_CAST(pcr_positivo_outro_virus AS STRING) pcr_positivo_outro_virus,
SAFE_CAST(pcr_sarscov2 AS INT64) pcr_sarscov2,
SAFE_CAST(pcr_virus_sincicial_respiratorio AS INT64) pcr_virus_sincicial_respiratorio,
SAFE_CAST(pcr_parainfluenza_1 AS STRING) pcr_parainfluenza_1,
SAFE_CAST(pcr_parainfluenza_2 AS STRING) pcr_parainfluenza_2,
SAFE_CAST(pcr_parainfluenza_3 AS STRING) pcr_parainfluenza_3,
SAFE_CAST(pcr_parainfluenza_4 AS STRING) pcr_parainfluenza_4,
SAFE_CAST(pcr_adenovirus AS INT64) pcr_adenovirus,
SAFE_CAST(pcr_metapneumovirus AS INT64) pcr_metapneumovirus,
SAFE_CAST(pcr_bocavirus AS INT64) pcr_bocavirus,
SAFE_CAST(pcr_rinovirus AS INT64) pcr_rinovirus,
SAFE_CAST(pcr_outro_virus AS STRING) pcr_outro_virus,
SAFE_CAST(qual_outro_virus AS STRING) qual_outro_virus,
SAFE_CAST(diagnostico_imunofluorescencia AS STRING) diagnostico_imunofluorescencia,
SAFE_CAST(resultado_imunofluorescencia AS STRING) resultado_imunofluorescencia,
SAFE_CAST(data_resultado_imunofluorescencia AS DATE) data_resultado_imunofluorescencia,
SAFE_CAST(id_laboratorio_imunofluorescencia AS STRING) id_laboratorio_imunofluorescencia,
SAFE_CAST(diagnostico_influenza_a AS STRING) diagnostico_influenza_a,
SAFE_CAST(diagnostico_subtipo_influenza_a AS STRING) diagnostico_subtipo_influenza_a,
SAFE_CAST(diagnostico_influenza_b AS STRING) diagnostico_influenza_b,
SAFE_CAST(diagnostico_virus_sincicial_respiratorio AS STRING) diagnostico_virus_sincicial_respiratorio,
SAFE_CAST(diagnostico_parainfluenza_1 AS STRING) diagnostico_parainfluenza_1,
SAFE_CAST(diagnostico_parainfluenza_2 AS STRING) diagnostico_parainfluenza_2,
SAFE_CAST(diagnostico_parainfluenza_3 AS STRING) diagnostico_parainfluenza_3,
SAFE_CAST(diagnostico_adenovirus AS STRING) diagnostico_adenovirus,
SAFE_CAST(diagnostico_outro_virus AS STRING) diagnostico_outro_virus,
SAFE_CAST(diagnostico_outra_metodologia AS STRING) diagnostico_outra_metodologia,
SAFE_CAST(imunofluorescencia_positivo_influenza AS STRING) imunofluorescencia_positivo_influenza,
SAFE_CAST(tipo_influenza_imunofluorescencia AS STRING) tipo_influenza_imunofluorescencia,
SAFE_CAST(imunofluorescencia_positivo_outro_virus AS STRING) imunofluorescencia_positivo_outro_virus,
SAFE_CAST(imunofluorescencia_virus_sincicial_respiratorio AS STRING) imunofluorescencia_virus_sincicial_respiratorio,
SAFE_CAST(imunofluorescencia_parainfluenza_1 AS STRING) imunofluorescencia_parainfluenza_1,
SAFE_CAST(imunofluorescencia_parainfluenza_2 AS STRING) imunofluorescencia_parainfluenza_2,
SAFE_CAST(imunofluorescencia_parainfluenza_3 AS STRING) imunofluorescencia_parainfluenza_3,
SAFE_CAST(imunofluorescencia_adenovirus AS STRING) imunofluorescencia_adenovirus,
SAFE_CAST(imunofluorescencia_outro_virus AS STRING) imunofluorescencia_outro_virus,
SAFE_CAST(imunofluorescencia_qual_outro_virus AS STRING) imunofluorescencia_qual_outro_virus,
SAFE_CAST(tipo_teste_antigenico AS STRING) tipo_teste_antigenico,
SAFE_CAST(data_resultado_teste AS DATE) data_resultado_teste,
SAFE_CAST(resultado_teste_antigenico AS STRING) resultado_teste_antigenico,
SAFE_CAST(teste_positivo_influenza AS STRING) teste_positivo_influenza,
SAFE_CAST(tipo_influenza_teste AS STRING) tipo_influenza_teste,
SAFE_CAST(teste_positivo_outro_virus AS STRING) teste_positivo_outro_virus,
SAFE_CAST(teste_sarscov2 AS STRING) teste_sarscov2,
SAFE_CAST(teste_virus_sincicial_respiratorio AS INT64) teste_virus_sincicial_respiratorio,
SAFE_CAST(teste_parainfluenza_1 AS STRING) teste_parainfluenza_1,
SAFE_CAST(teste_parainfluenza_2 AS STRING) teste_parainfluenza_2,
SAFE_CAST(teste_parainfluenza_3 AS STRING) teste_parainfluenza_3,
SAFE_CAST(teste_adenovirus AS INT64) teste_adenovirus,
SAFE_CAST(teste_outro_virus AS INT64) teste_outro_virus,
SAFE_CAST(teste_outro_virus_nome AS STRING) teste_outro_virus_nome,
SAFE_CAST(tipo_amostra_sorologica AS STRING) tipo_amostra_sorologica,
SAFE_CAST(qual_outra_amostra AS STRING) qual_outra_amostra,
SAFE_CAST(data_coleta_amostra AS DATE) data_coleta_amostra,
SAFE_CAST(tipo_sorologia AS STRING) tipo_sorologia,
SAFE_CAST(qual_outra_sorologia AS STRING) qual_outra_sorologia,
SAFE_CAST(data_resultado_sorologia AS DATE) data_resultado_sorologia,
SAFE_CAST(resultado_sorologia_igg AS STRING) resultado_sorologia_igg,
SAFE_CAST(resultado_sorologia_igm AS STRING) resultado_sorologia_igm,
SAFE_CAST(resultado_sorologia_iga AS STRING) resultado_sorologia_iga,
SAFE_CAST(historico_viagem AS STRING) historico_viagem,
SAFE_CAST(pais_viagem AS STRING) pais_viagem,
SAFE_CAST(local_viagem AS STRING) local_viagem,
SAFE_CAST(data_viagem AS STRING) data_viagem,
SAFE_CAST(data_retorno AS STRING) data_retorno,
SAFE_CAST(status_monitoramento AS STRING) status_monitoramento,
SAFE_CAST(classificacao_final AS STRING) classificacao_final,
SAFE_CAST(outro_agente_etiologico AS STRING) outro_agente_etiologico,
SAFE_CAST(criterio_encerramento AS STRING) criterio_encerramento,
SAFE_CAST(evolucao_caso AS STRING) evolucao_caso,
SAFE_CAST(data_alta_obito AS DATE) data_alta_obito,
SAFE_CAST(data_encerramento AS DATE) data_encerramento,
SAFE_CAST(data_digitacao AS DATE) data_digitacao,
SAFE_CAST(tipo_ficha AS STRING) tipo_ficha,
SAFE_CAST(requisicao_sistema_gal AS STRING) requisicao_sistema_gal,
SAFE_CAST(controle_srag_sinan AS STRING) controle_srag_sinan
FROM basedosdados-staging.br_ms_sinan_staging.microdados_influenza_srag AS t